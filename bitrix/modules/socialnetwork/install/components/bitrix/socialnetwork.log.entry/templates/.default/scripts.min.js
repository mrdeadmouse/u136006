window["__logCommentsListRedefine"]=function(e,t,s){if(!!window["UC"]&&!!window["UC"][e]){window["UC"][e].send=function(){this.logID=this.nav.getAttribute("bx-sonet-nav-event-id");this.commentID=this.nav.getAttribute("bx-sonet-nav-comment-id");this.commentTS=this.nav.getAttribute("bx-sonet-nav-comment-ts");this.entityType=this.nav.getAttribute("bx-sonet-nav-entity-type");this.ts=this.nav.getAttribute("bx-sonet-nav-ts");this.bFollow=this.nav.getAttribute("bx-sonet-nav-follow");this.status="busy";this.pageNumber=this.nav.getAttribute("bx-sonet-nav-page-number");BX.addClass(this.nav,"feed-com-all-hover");BX.ajax({method:"GET",url:BX.message("sonetLEGetPath")+"?"+BX.ajax.prepareData({sessid:BX.bitrix_sessid(),r:Math.floor(Math.random()*1e3),action:"get_comments",lang:BX.message("sonetLLangId"),site:BX.message("sonetLSiteId"),stid:BX.message("sonetLSiteTemplateId"),nt:BX.message("sonetLNameTemplate"),sl:BX.message("sonetLShowLogin"),dtf:BX.message("sonetLDateTimeFormat"),as:BX.message("sonetLAvatarSizeComment"),p_user:BX.message("sonetLPathToUser"),p_group:BX.message("sonetLPathToGroup"),p_dep:BX.message("sonetLPathToDepartment"),p_le:BX.message("sonetLEPath"),p_smile:BX.message("sonetLPathToSmile"),logid:this.logID,commentID:this.commentID,commentTS:this.commentTS,et:this.entityType,exmlid:e,PAGEN_1:this.pageNumber}),dataType:"json",onsuccess:BX.proxy(function(t){if(!(typeof t=="object"&&!!t)||t[0]=="*"){BX.debug(t)}else{var s=t["arComments"],n="";for(var a in s){var i=Math.floor(Math.random()*1e5)+1,o=s[a]["EVENT_FORMATTED"],r=s[a],l=!!window["__logBuildRating"]?window["__logBuildRating"](r["EVENT"],o,i):null,d=!!r["EVENT"]["SOURCE_ID"]?r["EVENT"]["SOURCE_ID"]:r["EVENT"]["ID"],p={ID:d,ENTITY_XML_ID:this.ENTITY_XML_ID,FULL_ID:[this.ENTITY_XML_ID,d],NEW:this.bFollow&&parseInt(r["LOG_DATE_TS"])>this.ts&&r["EVENT"]["USER_ID"]!=BX.message("sonetLCurrentUserID")?"Y":"N",APPROVED:"Y",POST_TIMESTAMP:r["LOG_DATE_TS"],POST_TIME:r["LOG_TIME_FORMAT"],POST_DATE:r["LOG_DATETIME_FORMAT"],"~POST_MESSAGE_TEXT":o["MESSAGE"],POST_MESSAGE_TEXT:o["FULL_MESSAGE_CUT"],URL:{LINK:r["URL"],EDIT:r["URL_EDIT"],DELETE:BX.message("sonetLESetPath")+"?lang="+BX.message("sonetLLangId")+"&action=delete_comment&delete_comment_id="+r["EVENT"]["ID"]+"&post_id="+this.logID+"&site="+BX.message("sonetLSiteId")},AUTHOR:{ID:r["EVENT"]["USER_ID"],NAME:r["CREATED_BY"]["FORMATTED"],URL:r["CREATED_BY"]["URL"],AVATAR:r["AVATAR_SRC"]},BEFORE_ACTIONS:!!l?l:"",AFTER:o["UF"],PANELS:r["PANELS"]};n+='<div id="record-'+this.ENTITY_XML_ID+"-"+d+'-cover" class="feed-com-block-cover">'+fcParseTemplate({messageFields:p})+"</div>";BX.onCustomEvent(window,"OnUCAddEntitiesCorrespondence",[e+"-"+r["EVENT"]["SOURCE_ID"],[this.logID,r["EVENT"]["ID"]]])}}this.build({status:true,navigation:typeof t["navigation"]!=="undefined"&&t["navigation"].length>0?t["navigation"]:"",navigationNextPageNum:typeof t["navigationNextPageNum"]!=="undefined"&&parseInt(t["navigationNextPageNum"])>0?parseInt(t["navigationNextPageNum"]):null,navigationCounter:typeof t["navigationCounter"]!=="undefined"&&parseInt(t["navigationCounter"])>0?parseInt(t["navigationCounter"]):null,messageList:n})},this),onfailure:BX.delegate(function(e){this.status="ready";BX.debug(e)},this)});return false};window["UC"][e].build=function(e){this.status="ready";this.wait("hide");BX.removeClass(this.nav,"feed-com-all-hover");if(!!e&&e["status"]==true){if(!!e["navigationNextPageNum"]&&!!e["navigationCounter"]&&parseInt(e["navigationNextPageNum"])>0&&parseInt(e["navigationCounter"])>0){this.nav.setAttribute("bx-sonet-nav-page-number",parseInt(e["navigationNextPageNum"]));BX.findChild(this.nav,{className:"feed-com-all-cnt"},true,false).innerHTML=parseInt(e["navigationCounter"])}else{BX.adjust(this.nav,{attrs:{href:"javascript:void(0);","bx-visibility-status":"visible"},html:BX.message("BLOG_C_HIDE")});this.status="done"}var t=!!e["navigation"]?BX.create("DIV",{html:e["navigation"]}):null,s=BX.processHTML(e["messageList"],false);var n=this.container.offsetHeight;if(this.order=="ASC")this.container.innerHTML=this.container.innerHTML+s.HTML;else this.container.innerHTML=s.HTML+this.container.innerHTML;BX.onCustomEvent(window,"OnUCFeedChanged",[[this.ENTITY_XML_ID,this.mid]]);this.display("show",n);BX.defer(function(){BX.ajax.processScripts(s.SCRIPT)})()}}}if(!!window.mplCheckForQuote)BX.bind(BX(t),"mouseup",function(t){mplCheckForQuote(t,this,e,s)})};window["__logBuildRating"]=function(e,t,s){var n="";s=!!s?s:Math.floor(Math.random()*1e5)+1;if(BX.message("sonetLShowRating")=="Y"&&!!e["RATING_TYPE_ID"]>0&&e["RATING_ENTITY_ID"]>0&&(BX.message("sonetLRatingType")=="like"&&!!window["RatingLike"]||BX.message("sonetLRatingType")=="standart_text"&&!!window["Rating"])){if(BX.message("sonetLRatingType")=="like"){var a=e["RATING_USER_VOTE_VALUE"]>0?" bx-you-like":"",i=e["RATING_USER_VOTE_VALUE"]>0?BX.message("sonetLTextLikeN"):BX.message("sonetLTextLikeY"),o=null;if(!!t["ALLOW_VOTE"]&&!!t["ALLOW_VOTE"]["RESULT"])o=BX.create("span",{props:{className:"bx-ilike-text"},html:i});n=BX.create("span",{attrs:{id:"sonet-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s},props:{className:"sonet-log-comment-like rating_vote_text"},children:[BX.create("span",{props:{className:"ilike-light"},children:[BX.create("span",{props:{id:"bx-ilike-button-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s,className:"bx-ilike-button"},children:[BX.create("span",{props:{className:"bx-ilike-right-wrap"+a},children:[BX.create("span",{props:{className:"bx-ilike-right"},html:e["RATING_TOTAL_POSITIVE_VOTES"]})]}),BX.create("span",{props:{className:"bx-ilike-left-wrap"},children:[o]})]}),BX.create("span",{props:{id:"bx-ilike-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s,className:"bx-ilike-wrap-block"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]})]})]})}else if(BX.message("sonetLRatingType")=="standart_text"){n=BX.create("span",{attrs:{id:"sonet-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s},props:{className:"sonet-log-comment-like rating_vote_text"},children:[BX.create("span",{props:{className:"bx-rating"+(!t["ALLOW_VOTE"]["RESULT"]?" bx-rating-disabled":"")+(e["RATING_USER_VOTE_VALUE"]!=0?" bx-rating-active":""),id:"bx-rating-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s,title:!t["ALLOW_VOTE"]["RESULT"]?t["ERROR_MSG"]:""},children:[BX.create("span",{props:{className:"bx-rating-absolute"},children:[BX.create("span",{props:{className:"bx-rating-question"},html:!t["ALLOW_VOTE"]["RESULT"]?BX.message("sonetLTextDenied"):BX.message("sonetLTextAvailable")}),BX.create("span",{props:{className:"bx-rating-yes "+(e["RATING_USER_VOTE_VALUE"]>0?"  bx-rating-yes-active":""),title:e["RATING_USER_VOTE_VALUE"]>0?BX.message("sonetLTextCancel"):BX.message("sonetLTextPlus")},children:[BX.create("a",{props:{className:"bx-rating-yes-count",href:"#like"},html:""+parseInt(e["RATING_TOTAL_POSITIVE_VOTES"])}),BX.create("a",{props:{className:"bx-rating-yes-text",href:"#like"},html:BX.message("sonetLTextRatingY")})]}),BX.create("span",{props:{className:"bx-rating-separator"},html:"/"}),BX.create("span",{props:{className:"bx-rating-no "+(e["RATING_USER_VOTE_VALUE"]<0?"  bx-rating-no-active":""),title:e["RATING_USER_VOTE_VALUE"]<0?BX.message("sonetLTextCancel"):BX.message("sonetLTextMinus")},children:[BX.create("a",{props:{className:"bx-rating-no-count",href:"#dislike"},html:""+parseInt(e["RATING_TOTAL_NEGATIVE_VOTES"])}),BX.create("a",{props:{className:"bx-rating-no-text",href:"#dislike"},html:BX.message("sonetLTextRatingN")})]})]})]}),BX.create("span",{props:{id:"bx-rating-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s+"-plus"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup  bx-rating-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]}),BX.create("span",{props:{id:"bx-rating-popup-cont-"+e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s+"-minus"},style:{display:"none"},children:[BX.create("span",{props:{className:"bx-ilike-popup  bx-rating-popup"},children:[BX.create("span",{props:{className:"bx-ilike-wait"}})]})]})]})}}if(!!n){n=BX.create("span",{children:[n]});n=n.innerHTML+'<script>window["#OBJ#"].Set("#ID#", "#RATING_TYPE_ID#", #RATING_ENTITY_ID#, "#ALLOW_VOTE#", BX.message("sonetLCurrentUserID"), #TEMPLATE#, "light", BX.message("sonetLPathToUser"));</script>'.replace("#OBJ#",BX.message("sonetLRatingType")=="like"?"RatingLike":"Rating").replace("#ID#",e["RATING_TYPE_ID"]+"-"+e["RATING_ENTITY_ID"]+"-"+s).replace("#RATING_TYPE_ID#",e["RATING_TYPE_ID"]).replace("#RATING_ENTITY_ID#",e["RATING_ENTITY_ID"]).replace("#ALLOW_VOTE#",!!t["ALLOW_VOTE"]&&!!t["ALLOW_VOTE"]["RESULT"]?"Y":"N").replace("#TEMPLATE#",BX.message("sonetLRatingType")=="like"?'{LIKE_Y:BX.message("sonetLTextLikeN"),LIKE_N:BX.message("sonetLTextLikeY"),LIKE_D:BX.message("sonetLTextLikeD")}':'{PLUS:BX.message("sonetLTextPlus"),MINUS:BX.message("sonetLTextMinus"),CANCEL:BX.message("sonetLTextCancel")}')}return n};window["__logShowCommentForm"]=function(e){if(!!window["UC"][e])window["UC"][e].reply()};var waitTimeout=null;var waitDiv=null;var waitPopup=null;var waitTime=500;function __logEventExpand(e){if(BX(e)){BX(e).style.display="none";var t=BX.findParent(BX(e),{tag:"div",className:"feed-post-text-block"});if(t){var s=BX.findChild(t,{tag:"div",className:"feed-post-text-block-inner"},true);var n=BX.findChild(t,{tag:"div",className:"feed-post-text-block-inner-inner"},true);if(s&&n){fxStart=300;fxFinish=n.offsetHeight;new BX.fx({time:1*(n.offsetHeight-fxStart)/(1200-fxStart),step:.05,type:"linear",start:fxStart,finish:fxFinish,callback:BX.delegate(__logEventExpandSetHeight,s),callback_complete:BX.delegate(function(){s.style.maxHeight="none";BX.LazyLoad.showImages(true)})}).start()}}}}function __logCommentExpand(e){if(!BX.type.isDomNode(e))e=BX.proxy_context;if(BX(e)){var t=BX.findParent(BX(e),{tag:"div",className:"feed-com-text"});if(t){BX.remove(e);var s=BX.findChild(t,{tag:"div",className:"feed-com-text-inner"},true);var n=BX.findChild(t,{tag:"div",className:"feed-com-text-inner-inner"},true);if(n&&s){fxStart=200;fxFinish=n.offsetHeight;var a=1*(fxFinish-fxStart)/(2e3-fxStart);if(a<.3)a=.3;if(a>.8)a=.8;new BX.fx({time:a,step:.05,type:"linear",start:fxStart,finish:fxFinish,callback:BX.delegate(__logEventExpandSetHeight,s),callback_complete:BX.delegate(function(){s.style.maxHeight="none"})}).start()}}}}function __logEventExpandSetHeight(e){this.style.maxHeight=e+"px"}function __logShowHiddenDestination(e,t,s){var n=new XMLHttpRequest;n.open("POST",BX.message("sonetLESetPath"),true);n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");n.onreadystatechange=function(){if(n.readyState==4){if(n.status==200){var e=LBlock.DataParser(n.responseText);if(typeof e=="object"){if(e[0]=="*"){if(sonetLErrorDiv!=null){sonetLErrorDiv.style.display="block";sonetLErrorDiv.innerHTML=n.responseText}return}n.abort();var t=e["arDestinations"];if(typeof t=="object"){if(BX(s)){var a=s.parentNode;a.removeChild(s);var i="";for(var o=0;o<t.length;o++){if(typeof t[o]["TITLE"]!="undefined"&&t[o]["TITLE"].length>0){a.appendChild(BX.create("SPAN",{html:",&nbsp;"}));if(typeof t[o]["CRM_PREFIX"]!="undefined"&&t[o]["CRM_PREFIX"].length>0){a.appendChild(BX.create("SPAN",{props:{className:"feed-add-post-destination-prefix"},html:t[o]["CRM_PREFIX"]+":&nbsp;"}))}if(typeof t[o]["URL"]!="undefined"&&t[o]["URL"].length>0){a.appendChild(BX.create("A",{props:{className:"feed-add-post-destination-new"+(typeof t[o]["IS_EXTRANET"]!="undefined"&&t[o]["IS_EXTRANET"]=="Y"?" feed-post-user-name-extranet":""),href:t[o]["URL"]},html:t[o]["TITLE"]}))}else{a.appendChild(BX.create("SPAN",{props:{className:"feed-add-post-destination-new"+(typeof t[o]["IS_EXTRANET"]!="undefined"&&t[o]["IS_EXTRANET"]=="Y"?" feed-post-user-name-extranet":"")},html:t[o]["TITLE"]}))}}}if(e["iDestinationsHidden"]!="undefined"&&parseInt(e["iDestinationsHidden"])>0){e["iDestinationsHidden"]=parseInt(e["iDestinationsHidden"]);if(e["iDestinationsHidden"]%100>10&&e["iDestinationsHidden"]%100<20)var r=5;else var r=e["iDestinationsHidden"]%10;a.appendChild(BX.create("SPAN",{html:"&nbsp;"+BX.message("sonetLDestinationHidden"+r).replace("#COUNT#",e["iDestinationsHidden"])}))}}}}}else{}}};n.send("r="+Math.floor(Math.random()*1e3)+"&"+BX.message("sonetLSessid")+"&site="+BX.util.urlencode(BX.message("SITE_ID"))+"&nt="+BX.util.urlencode(BX.message("sonetLNameTemplate"))+"&log_id="+encodeURIComponent(e)+(t?"&created_by_id="+encodeURIComponent(t):"")+"&p_user="+BX.util.urlencode(BX.message("sonetLPathToUser"))+"&p_group="+BX.util.urlencode(BX.message("sonetLPathToGroup"))+"&p_dep="+BX.util.urlencode(BX.message("sonetLPathToDepartment"))+"&dlim="+BX.util.urlencode(BX.message("sonetLDestinationLimit"))+"&action=get_more_destination")}function __logSetFollow(e){var t=BX("log_entry_follow_"+e,true).getAttribute("data-follow")=="Y"?"Y":"N";var s=t=="Y"?"N":"Y";if(BX("log_entry_follow_"+e,true)){BX.findChild(BX("log_entry_follow_"+e,true),{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+s);BX("log_entry_follow_"+e,true).setAttribute("data-follow",s)}BX.ajax({url:BX.message("sonetLSetPath"),method:"POST",dataType:"json",data:{log_id:e,action:"change_follow",follow:s,sessid:BX.bitrix_sessid(),site:BX.message("sonetLSiteId")},onsuccess:function(s){if(s["SUCCESS"]!="Y"&&BX("log_entry_follow_"+e,true)){BX.findChild(BX("log_entry_follow_"+e,true),{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+t);BX("log_entry_follow_"+e,true).setAttribute("data-follow",t)}},onfailure:function(s){if(BX("log_entry_follow_"+e,true)){BX.findChild(BX("log_entry_follow_"+e,true),{tagName:"a"}).innerHTML=BX.message("sonetLFollow"+t);BX("log_entry_follow_"+e,true).setAttribute("data-follow",t)}}});return false}function __logRefreshEntry(e){var t=e.node!==undefined?BX(e.node):false;var s=e.logId!==undefined?parseInt(e.logId):0;if(!t||s<=0||BX.message("sonetLEPath")===undefined){return}BX.ajax({url:BX.message("sonetLEPath").replace("#log_id#",s),method:"POST",dataType:"json",data:{log_id:s,action:"get_entry"},onsuccess:function(e){if(e["ENTRY_HTML"]!==undefined){BX.cleanNode(t);t.innerHTML=e["ENTRY_HTML"];var s=BX.processHTML(t.innerHTML,true);var n=s.SCRIPT;BX.ajax.processScripts(n,true)}},onfailure:function(e){}});return false}window.__logEditComment=function(e,t,s){BX.ajax({url:BX.message("sonetLESetPath"),method:"POST",dataType:"json",data:{comment_id:t,post_id:s,site:BX.message("sonetLSiteId"),action:"get_comment_src",sessid:BX.bitrix_sessid()},onsuccess:function(s){if(typeof s.message!="undefined"&&typeof s.sourceId!="undefined"){var n={messageBBCode:s.message,messageFields:{arFiles:typeof top["arLogComFiles"+t]!="undefined"?top["arLogComFiles"+t]:[]}};if(top["arLogComDocsType"+t]=="webdav_element"&&typeof top["arLogComDocs"+t]!="undefined")n["messageFields"]["arDocs"]=top["arLogComDocs"+t];if(top["arLogComDocsType"+t]=="disk_file"&&typeof top["arLogComDocs"+t]!="undefined")n["messageFields"]["arDFiles"]=top["arLogComDocs"+t];BX.onCustomEvent(window,"OnUCAfterRecordEdit",[e,s.sourceId,n,"EDIT"])}},onfailure:function(e){}})};
//# sourceMappingURL=scripts.map.js