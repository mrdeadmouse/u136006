if(!BXRL){var BXRL={}}if(typeof bRatingLikeCommentsInited=="undefined"){var bRatingLikeCommentsInited=true;BX.addCustomEvent("onPull-main",function(e){if(e.command=="rating_vote"){RatingLikeComments.LiveUpdate(e.params)}})}RatingLikeComments=function(e,t,n,i){this.enabled=true;this.entityTypeId=t;this.entityId=n;this.available=i=="Y";this.box=BX("bx-ilike-button-"+e);this.countText=BX("bx-ilike-count-"+e);if(this.box===null){this.enabled=false;return false}this.likeTimeout=false;this.lastVote=BX.hasClass(this.box,"post-comment-likes-liked")?"plus":"cancel"};RatingLikeComments.Set=function(e,t,n,i){BXRL[e]=new RatingLikeComments(e,t,n,i);if(BXRL[e].enabled){RatingLikeComments.Init(e)}};RatingLikeComments.Init=function(e){if(BXRL[e].available){BX.bind(BXRL[e].box,"click",function(t){clearTimeout(BXRL[e].likeTimeout);var n=typeof BXRL[e].countText.innerHTML=="undefined"||BXRL[e].countText.innerHTML==null||BXRL[e].countText.innerHTML==""?0:parseInt(BXRL[e].countText.innerHTML);var i=BX.hasClass(BXRL[e].box,"post-comment-likes-liked")?"plus":"cancel";var s=i=="plus"?"cancel":"plus";BXRL[e].countText.innerHTML=i=="plus"?n-1:n+1;BX.removeClass(BXRL[e].box,i=="plus"?"post-comment-likes-liked":"post-comment-likes");BX.addClass(BXRL[e].box,i=="plus"?"post-comment-likes":"post-comment-likes-liked");BXRL[e].likeTimeout=setTimeout(function(){if(BXRL[e].lastVote!=s){RatingLikeComments.Vote(e,s)}},1e3);BX.PreventDefault(t)})}};RatingLikeComments.Vote=function(e,t){var n=new MobileAjaxWrapper;n.Wrap({type:"json",method:"POST",url:"/mobile/ajax.php?mobile_action=like",data:{RATING_VOTE:"Y",RATING_VOTE_TYPE_ID:BXRL[e].entityTypeId,RATING_VOTE_ENTITY_ID:BXRL[e].entityId,RATING_VOTE_ACTION:t,sessid:BX.message("RVCSessID")},callback:function(n){if(typeof n!="undefined"&&typeof n.action!="undefined"&&typeof n.items_all!="undefined"){BXRL[e].lastVote=n.action;BXRL[e].countText.innerHTML=n.items_all}else{BX.removeClass(BXRL[e].box,t=="plus"?"post-comment-likes-liked":"post-comment-likes");BX.addClass(BXRL[e].box,t=="plus"?"post-comment-likes":"post-comment-likes-liked");var i=t=="plus"?parseInt(BXRL[e].countText.innerHTML)-1:parseInt(BXRL[e].countText.innerHTML)+1;BXRL[e].countText.innerHTML=i}},callback_failure:function(n){BX.removeClass(BXRL[e].box,t=="plus"?"post-comment-likes-liked":"post-comment-likes");BX.addClass(BXRL[e].box,t=="plus"?"post-comment-likes":"post-comment-likes-liked");var i=t=="plus"?parseInt(BXRL[e].countText.innerHTML)-1:parseInt(BXRL[e].countText.innerHTML)+1;BXRL[e].countText.innerHTML=i}});return false};RatingLikeComments.List=function(e){if(app.enableInVersion(2)){app.openTable({callback:function(){},url:(BX.message("MobileSiteDir")?BX.message("MobileSiteDir"):"/")+"mobile/index.php?mobile_action=get_likes&RATING_VOTE_TYPE_ID="+BXRL[e].entityTypeId+"&RATING_VOTE_ENTITY_ID="+BXRL[e].entityId+"&URL="+BX.message("RVCPathToUserProfile"),markmode:false,showtitle:false,modal:false,cache:false,outsection:false,cancelname:BX.message("RVCListBack")})}return false};RatingLikeComments.LiveUpdate=function(e){if(e.USER_ID==BX.message("USER_ID")){return false}for(var t in BXRL){if(BXRL[t].entityTypeId==e.ENTITY_TYPE_ID&&BXRL[t].entityId==e.ENTITY_ID){oMSL.onLogCommentRatingLike({ratingId:t,voteAction:e.TYPE=="ADD"?"plus":"cancel",userId:e.USER_ID})}}};
//# sourceMappingURL=script_attached.map.js