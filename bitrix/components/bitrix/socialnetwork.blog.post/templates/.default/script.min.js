function showHiddenDestination(t,e){BX.hide(e);BX("blog-destination-hidden-"+t).style.display="inline"}function showMenuLinkInput(t,e){id="post-menu-"+t+"-link",it=BX.proxy_context,height=parseInt(!!it.getAttribute("bx-height")?it.getAttribute("bx-height"):it.offsetHeight);if(it.getAttribute("bx-status")!="shown"){it.setAttribute("bx-status","shown");if(!BX(id)&&!!BX(id+"-text")){var i=BX(id+"-text"),o=BX.pos(i),s=BX.pos(i.parentNode);pos3=BX.pos(BX.findParent(i,{className:"menu-popup-item"},true));o["height"]=s["height"]-1;BX.adjust(it,{attrs:{"bx-height":it.offsetHeight},style:{overflow:"hidden",display:"block"},children:[BX.create("BR"),BX.create("DIV",{attrs:{id:id},children:[BX.create("SPAN",{attrs:{className:"menu-popup-item-left"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-icon"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-text"},children:[BX.create("INPUT",{attrs:{id:id+"-input",type:"text",value:e},style:{height:o["height"]+"px",width:pos3["width"]-21+"px"},events:{click:function(t){this.select();BX.PreventDefault(t)}}})]})]}),BX.create("SPAN",{className:"menu-popup-item-right"})]})}new BX.fx({time:.2,step:.05,type:"linear",start:height,finish:height*2,callback:BX.delegate(function(t){this.style.height=t+"px"},it)}).start();BX.fx.show(BX(id),.2);BX(id+"-input").select()}else{it.setAttribute("bx-status","hidden");new BX.fx({time:.2,step:.05,type:"linear",start:it.offsetHeight,finish:height,callback:BX.delegate(function(t){this.style.height=t+"px"},it)}).start();BX.fx.hide(BX(id),.2)}}function showBlogPost(t,e){var i=BX.findChild(BX("blg-post-"+t),{className:"feed-post-text-block-inner"},true,false);el2=BX.findChild(BX("blg-post-"+t),{className:"feed-post-text-block-inner-inner"},true,false);BX.remove(e);if(i){var o=300;var s=el2.offsetHeight;new BX.fx({time:1*(s-o)/(1200-o),step:.05,type:"linear",start:o,finish:s,callback:BX.delegate(__blogExpandSetHeight,i),callback_complete:BX.delegate(function(){this.style.maxHeight="none";BX.LazyLoad.showImages(true)},i)}).start()}}function __blogExpandSetHeight(t){this.style.maxHeight=t+"px"}function deleteBlogPost(t){url=BX.message("sonetBPDeletePath");url1=url.replace("#del_post_id#",t);if(BX.findChild(BX("blg-post-"+t),{attr:{id:"form_c_del"}},true,false)){BX.hide(BX("form_c_del"));BX(BX("blg-post-"+t).parentNode.parentNode).appendChild(BX("form_c_del"))}BX.ajax.get(url1,function(e){if(window.deletePostEr&&window.deletePostEr=="Y"){var i=BX("blg-post-"+t);BX.findChild(i,{className:"feed-post-cont-wrap"},true,false).insertBefore(BX.create("SPAN",{html:e}),BX.findChild(i,{className:"feed-user-avatar"},true,false))}else{BX("blg-post-"+t).parentNode.innerHTML=e}});return false}var waitPopupBlogImage=null;function blogShowImagePopup(t){if(!waitPopupBlogImage){waitPopupBlogImage=new BX.PopupWindow("blogwaitPopupBlogImage",window,{autoHide:true,lightShadow:false,zIndex:2,content:BX.create("IMG",{props:{src:t,id:"blgimgppp"}}),closeByEsc:true,closeIcon:true})}else{BX("blgimgppp").src="/bitrix/images/1.gif";BX("blgimgppp").src=t}waitPopupBlogImage.setOffset({offsetTop:0,offsetLeft:0});setTimeout(function(){waitPopupBlogImage.adjustPosition()},100);waitPopupBlogImage.show()}function __blogPostSetFollow(t){var e=BX("log_entry_follow_"+t,true).getAttribute("data-follow")=="Y"?"Y":"N";var i=e=="Y"?"N":"Y";if(BX("log_entry_follow_"+t,true)){BX.findChild(BX("log_entry_follow_"+t,true),{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+i);BX("log_entry_follow_"+t,true).setAttribute("data-follow",i)}BX.ajax({url:BX.message("sonetBPSetPath"),method:"POST",dataType:"json",data:{log_id:t,action:"change_follow",follow:i,sessid:BX.bitrix_sessid(),site:BX.message("sonetBPSiteId")},onsuccess:function(i){if(i["SUCCESS"]!="Y"&&BX("log_entry_follow_"+t,true)){BX.findChild(BX("log_entry_follow_"+t,true),{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+e);BX("log_entry_follow_"+t,true).setAttribute("data-follow",e)}},onfailure:function(i){if(BX("log_entry_follow_"+t,true)){BX.findChild(BX("log_entry_follow_"+t,true),{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+e);BX("log_entry_follow_"+t,true).setAttribute("data-follow",e)}}});return false}(function(){if(!!window.SBPImpPost)return false;window.SBPImpPost=function(t){if(t.getAttribute("sbpimppost")=="Y")return false;this.CID="sbpimppost"+(new Date).getTime();this.busy=false;this.node=t;this.btn=t.parentNode;this.block=t.parentNode.parentNode;this.postId=t.getAttribute("bx-blog-post-id");t.setAttribute("sbpimppost","Y");BX.onCustomEvent(this.node,"onInit",[this]);if(this.postId>0)this.onclick();return false};window.SBPImpPost.prototype.onclick=function(){this.sendData()};window.SBPImpPost.prototype.showClick=function(){var t=this.btn.offsetWidth,e=BX.message("BLOG_ALREADY_READ"),i=BX.create("span",{props:{className:"have-read-text-block"},html:"<i></i>"+e+'<span class="feed-imp-post-footer-comma">,</span>'});this.block.style.minWidth=this.btn.offsetWidth-27+"px";var o=new BX.easing({duration:250,start:{width:t},finish:{width:1},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate(function(t){this.btn.style.width=t.width+"px"},this),complete:BX.delegate(function(){this.btn.innerHTML="";this.btn.appendChild(i);var t=i.offsetWidth,e=new BX.easing({duration:300,start:{width_2:0},finish:{width_2:t},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate(function(t){this.btn.style.width=t.width_2+"px"},this)});e.animate()},this)});o.animate()};window.SBPImpPost.prototype.wait=function(t){t=t=="show"?"show":"hide";if(t=="show"){this.node.disabled=true;BX.adjust(this.node,{style:{position:"relative"},children:[BX.create("DIV",{attrs:{className:"mpf-load-img","mpf-load-img":"Y"},style:{position:"absolute",top:0,left:0,width:"100%"}})]})}else{if(!!this.node.lastChild&&this.node.lastChild.hasAttribute("mpf-load-img")){BX.remove(this.node.lastChild)}}};window.SBPImpPost.prototype.sendData=function(){if(this.busy)return false;this.busy=true;window["node"]=this.node;window["obj"]=this;this.wait("show");var t={options:[{post_id:this.postId,name:"BLOG_POST_IMPRTNT",value:"Y"}],sessid:BX.bitrix_sessid()},e=this.node.href;BX.onCustomEvent(this.node,"onSend",[t]);t=BX.ajax.prepareData(t);if(t){e+=(e.indexOf("?")!==-1?"&":"?")+t;t=""}BX.ajax({method:"GET",url:e,dataType:"json",onsuccess:BX.delegate(function(t){this.busy=false;this.wait("hide");this.showClick();BX.onCustomEvent(this.node,"onUserVote",[t]);BX.onCustomEvent("onImportantPostRead",[this.postId,this.CID])},this),onfailure:BX.delegate(function(t){this.busy=false;this.wait("hide")},this)})};top.SBPImpPostCounter=function(t,e,i){this.parentNode=t;this.node=BX.findChild(t,{tagName:"A"});if(!this.node)return false;BX.addCustomEvent(this.node,"onUserVote",BX.delegate(function(t){this.change(t)},this));this.parentNode.SBPImpPostCounter=this;this.node.setAttribute("status","ready");this.node.setAttribute("inumpage",0);this.postId=e;this.popup=null;this.data=[];BX.bind(t,"click",BX.proxy(function(){this.get()},this));BX.bind(t,"mouseover",BX.proxy(function(t){this.init(t)},this));BX.bind(t,"mouseout",BX.proxy(function(t){this.init(t)},this));this.pathToUser=i["pathToUser"];this.nameTemplate=i["nameTemplate"];this.onPullEvent=BX.delegate(function(t,e){if(t=="read"&&!!e&&e["POST_ID"]==this.postId){if(!!e["data"]){this.change(e["data"])}}},this);BX.addCustomEvent("onPullEvent-socialnetwork",this.onPullEvent)};top.SBPImpPostCounter.prototype.click=function(t){t.uController=this;BX.addCustomEvent(t.node,"onUserVote",BX.proxy(this.change,this));BX.addCustomEvent(t.node,"onSend",BX.proxy(function(t){t["PATH_TO_USER"]=this.pathToUser;t["NAME_TEMPLATE"]=this.nameTemplate;t["iNumPage"]=0;t["ID"]=this.postId;t["post_id"]=this.postId;t["name"]="BLOG_POST_IMPRTNT";t["value"]="Y";t["return"]="users"},this));this.btnObj=t};top.SBPImpPostCounter.prototype.change=function(t){if(!!t&&!!t.items){var e=false;this.data=[];for(var i in t.items){this.data.push(t.items[i])}if(t["StatusPage"]=="done")this.node.setAttribute("inumpage","done");else this.node.setAttribute("inumpage",1);BX.adjust(this.parentNode,{style:{display:"inline-block"}})}else{this.node.setAttribute("inumpage","done");BX.hide(this.parentNode)}this.node.firstChild.innerHTML=t["RecordCount"]};top.SBPImpPostCounter.prototype.init=function(t){if(!!this.node.timeoutOver){clearTimeout(this.node.timeoutOver);this.node.timeoutOver=false}if(t.type=="mouseover"){if(!this.node.mouseoverFunc){this.node.mouseoverFunc=BX.delegate(function(){this.get();if(this.popup){BX.bind(this.popup.popupContainer,"mouseout",BX.proxy(function(){this.popup.timeoutOut=setTimeout(BX.proxy(function(){if(!!this.popup){this.popup.close()}},this),400)},this));BX.bind(this.popup.popupContainer,"mouseover",BX.proxy(function(){if(this.popup.timeoutOut)clearTimeout(this.popup.timeoutOut)},this))}},this)}this.node.timeoutOver=setTimeout(this.node.mouseoverFunc,400)}};top.SBPImpPostCounter.prototype.get=function(){if(this.node.getAttribute("inumpage")!="done")this.node.setAttribute("inumpage",parseInt(this.node.getAttribute("inumpage"))+1);this.show();if(this.data.length>0){this.make(this.node.getAttribute("inumpage")!="done")}if(this.node.getAttribute("inumpage")!="done"){this.node.setAttribute("status","busy");BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.blog.blog/users.php",method:"POST",dataType:"json",data:{ID:this.postId,post_id:this.postId,name:"BLOG_POST_IMPRTNT",value:"Y",iNumPage:this.node.getAttribute("inumpage"),PATH_TO_USER:this.pathToUser,NAME_TEMPLATE:this.nameTemplate,sessid:BX.bitrix_sessid()},onsuccess:BX.proxy(function(t){if(!!t&&!!t.items){var e=false;for(var i in t.items){this.data.push(t.items[i])}if(t.StatusPage=="done")this.node.setAttribute("inumpage","done");this.make(this.node.getAttribute("inumpage")!="done")}else{this.node.setAttribute("inumpage","done")}this.node.firstChild.innerHTML=t["RecordCount"];this.node.setAttribute("status","ready")},this),onfailure:BX.proxy(function(t){this.node.setAttribute("status","ready")},this)})}};top.SBPImpPostCounter.prototype.show=function(){if(this.popup!=null)this.popup.close();if(this.popup==null){this.popup=new BX.PopupWindow("bx-vote-popup-cont-"+this.postId,this.node,{lightShadow:true,offsetTop:-2,offsetLeft:3,autoHide:true,closeByEsc:true,bindOptions:{position:"top"},events:{onPopupClose:function(){this.destroy()},onPopupDestroy:BX.proxy(function(){this.popup=null},this)},content:BX.create("SPAN",{props:{className:"bx-ilike-wait"}})});this.popup.isNew=true;this.popup.show()}this.popup.setAngle({position:"bottom"});this.popup.bindOptions.forceBindPosition=true;this.popup.adjustPosition();this.popup.bindOptions.forceBindPosition=false};top.SBPImpPostCounter.prototype.make=function(t){if(!this.popup)return true;t=t===false?false:true;var e=this.popup&&this.popup.contentContainer?this.popup.contentContainer:BX("popup-window-content-bx-vote-popup-cont-"+this.postId),i=false,o=false,s=this.data;if(this.popup.isNew){var i=BX.create("SPAN",{props:{className:"bx-ilike-popup"},children:[BX.create("SPAN",{props:{className:"bx-ilike-bottom_scroll"}})]}),o=BX.create("SPAN",{props:{className:"bx-ilike-wrap-block"},children:[i]})}else{i=BX.findChild(this.popup.contentContainer,{className:"bx-ilike-popup"},true)}if(!!i){for(var n in s){if(!BX.findChild(i,{tag:"A",attr:{id:"u"+s[n]["ID"]}},true)){i.appendChild(BX.create("A",{attrs:{id:"u"+s[n]["ID"]},props:{href:s[n]["URL"],target:"_blank",className:"bx-ilike-popup-img"},text:"",children:[BX.create("SPAN",{props:{className:"bx-ilike-popup-avatar"},html:s[n]["PHOTO"]}),BX.create("SPAN",{props:{className:"bx-ilike-popup-name"},html:s[n]["FULL_NAME"]})]}))}}if(t){BX.bind(i,"scroll",BX.delegate(this.popupScrollCheck,this))}}if(this.popup.isNew){this.popup.isNew=false;if(!!e){try{e.removeChild(e.firstChild)}catch(a){}e.appendChild(o)}}if(this.popup!=null){this.popup.bindOptions.forceBindPosition=true;this.popup.adjustPosition();this.popup.bindOptions.forceBindPosition=false}};top.SBPImpPostCounter.prototype.popupScrollCheck=function(){var t=BX.proxy_context;if(t.scrollTop>(t.scrollHeight-t.offsetHeight)/1.5){BX.unbind(t,"scroll",BX.delegate(this.popupScrollCheck,this));this.get()}}})(window);window.BXfpdPostSelectCallback=function(t,e,i){if(!BX.findChild(BX("feed-add-post-destination-item-post"),{attr:{"data-id":t.id}},false,false)){var o=e;prefix="S";if(e=="sonetgroups")prefix="SG";else if(e=="groups"){prefix="UA";o="all-users"}else if(e=="users")prefix="U";else if(e=="department")prefix="DR";var s=e=="sonetgroups"&&typeof window["arExtranetGroupID"]!="undefined"&&BX.util.in_array(t.entityId,window["arExtranetGroupID"])?" feed-add-post-destination-extranet":"";BX("feed-add-post-destination-item-post").appendChild(BX.create("span",{attrs:{"data-id":t.id},props:{className:"feed-add-post-destination feed-add-post-destination-"+o+s},children:[BX.create("input",{attrs:{type:"hidden",name:"SPERM["+prefix+"][]",value:t.id}}),BX.create("span",{props:{className:"feed-add-post-destination-text"},html:t.name}),BX.create("span",{props:{className:"feed-add-post-del-but"},events:{click:function(i){BX.SocNetLogDestination.deleteItem(t.id,e,BXSocNetLogDestinationFormNamePost);BX.PreventDefault(i)},mouseover:function(){BX.addClass(this.parentNode,"feed-add-post-destination-hover")},mouseout:function(){BX.removeClass(this.parentNode,"feed-add-post-destination-hover")}}})]}))}BX("feed-add-post-destination-input-post").value="";BX.SocNetLogDestination.BXfpSetLinkName({formName:window.BXSocNetLogDestinationFormNamePost,tagInputName:"bx-destination-tag-post",tagLink1:BX.message("BX_FPD_LINK_1"),tagLink2:BX.message("BX_FPD_LINK_2")})};window.BXfpdPostClear=function(){var t=BX.findChildren(BX("feed-add-post-destination-item-post"),{className:"feed-add-post-destination"},true);if(t!=null){for(var e=0;e<t.length;e++){BX.remove(t[e])}}BX("feed-add-post-destination-input-post").value="";BX.SocNetLogDestination.BXfpSetLinkName({formName:window.BXSocNetLogDestinationFormNamePost,tagInputName:"bx-destination-tag-post",tagLink1:BX.message("BX_FPD_LINK_1"),tagLink2:BX.message("BX_FPD_LINK_2")})};window.showSharing=function(t,e){BXfpdPostClear();BX("sharePostId").value=t;BX("shareUserId").value=e;BX.SocNetLogDestination.obItemsSelected[BXSocNetLogDestinationFormNamePost]={};if(window["postDest"+t]){for(var i=0;i<window["postDest"+t].length;i++){if(BX.SocNetLogDestination.obItemsSelected[BXSocNetLogDestinationFormNamePost]){BX.SocNetLogDestination.obItemsSelected[BXSocNetLogDestinationFormNamePost][window["postDest"+t][i].id]=window["postDest"+t][i].type}if(!BX.SocNetLogDestination.obItems[BXSocNetLogDestinationFormNamePost][window["postDest"+t][i].type][window["postDest"+t][i].id]){BX.SocNetLogDestination.obItems[BXSocNetLogDestinationFormNamePost][window["postDest"+t][i].type][window["postDest"+t][i].id]={avatar:"",entityId:window["postDest"+t][i].entityId,id:window["postDest"+t][i].id,name:window["postDest"+t][i].name}}}if(BXSocNetLogDestinationFormNamePost)BX.SocNetLogDestination.reInit(BXSocNetLogDestinationFormNamePost);var o=BX.findChildren(BX("feed-add-post-destination-item-post"),{className:"feed-add-post-destination"},true);if(o!=null){for(var s=0;s<o.length;s++){BX.addClass(o[s],"feed-add-post-destination-undelete");BX.remove(o[s].lastChild)}}var n=BX("destination-sharing");if(BX("blg-post-destcont-"+t)){BX("blg-post-destcont-"+t).appendChild(n)}n.style.height=0;n.style.opacity=0;n.style.overflow="hidden";n.style.display="inline-block";new BX.easing({duration:500,start:{opacity:0,height:0},finish:{opacity:100,height:n.scrollHeight-40},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){n.style.height=t.height+"px";n.style.opacity=t.opacity/100},complete:function(){n.style.cssText=""}}).animate()}};window.closeSharing=function(){var t=BX("destination-sharing");if(BX("sharePostSubmitButton")){BX.removeClass(BX("sharePostSubmitButton"),"feed-add-button-load")}new BX.easing({duration:500,start:{opacity:100,height:t.scrollHeight-40},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){t.style.height=e.height+"px";t.style.opacity=e.opacity/100},complete:function(){BX.hide(t)}}).animate()};window.sharingPost=function(){var t=BX("sharePostId").value;var e=BX("shareUserId").value;var i=BX("blogShare");var o=socBPDest.shareUrl.replace(/#post_id#/,t).replace(/#user_id#/,e);if(BX("sharePostSubmitButton")){BX.addClass(BX("sharePostSubmitButton"),"feed-add-button-load")}var s=BX.findChildren(BX("feed-add-post-destination-item-post"),{className:"feed-add-post-destination"},true);if(s!=null){var n=BX("blog-destination-hidden-"+t);if(!n){var a=BX.findChildren(BX("blg-post-img-"+t),{className:"feed-add-post-destination-new"},true);var p=a[a.length-1]}for(var d=0;d<s.length;d++){if(!BX.hasClass(s[d],"feed-add-post-destination-undelete")){var r=BX.findChild(s[d],{className:"feed-add-post-destination-text"},false,false).innerHTML;var l=BX.findChild(s[d],{tag:"input"},false,false);var u=l.value;var h;if(l.name=="SPERM[SG][]")h="sonetgroups";else if(l.name=="SPERM[DR][]")h="department";else if(l.name=="SPERM[G][]")h="groups";else if(l.name=="SPERM[U][]")h="users";else if(l.name=="SPERM[UA][]")h="groups";if(h.length>0){window["postDest"+t].push({id:u,name:r,type:h});var f=BX.create("span",{children:[BX.create("span",{html:", "}),BX.create("a",{props:{className:"feed-add-post-destination-new"},href:"",html:r})]});if(n){n.appendChild(f)}else if(p){BX(p.parentNode).insertBefore(f,p.nextSibling)}}}}}i.action=o;i.target="";var c,B="";var m=i.elements.length;var g="";for(c=0;c<m;c++){if(B!="")g="&";var a=i.elements[c];if(a.disabled)continue;switch(a.type.toLowerCase()){case"text":case"hidden":B+=g+a.name+"="+BX.util.urlencode(a.value);break;default:break}}B+="&save=Y";BX.ajax({method:"POST",dataType:"html",url:o,data:B,async:true,processData:false});closeSharing()};
//# sourceMappingURL=script.map.js