BX.CLBlock=function(e){this.arData=new Array;this.arData["Subscription"]=new Array;this.UTPopup=null;this.entity_type=null;this.entity_id=null;this.event_id=null;this.event_id_fullset=false;this.cb_id=null;this.t_val=null;this.ind=null;this.type=null};BX.CLBlock.prototype.DataParser=function(str){str=str.replace(/^\s+|\s+$/g,"");while(str.length>0&&str.charCodeAt(0)==65279)str=str.substring(1);if(str.length<=0)return false;if(str.substring(0,1)!="{"&&str.substring(0,1)!="["&&str.substring(0,1)!="*")str='"*"';eval("arData = "+str);return arData};function __logFilterShow(){if(BX("bx_sl_filter").style.display=="none"){BX("bx_sl_filter").style.display="block";BX("bx_sl_filter_hidden").style.display="none"}else{BX("bx_sl_filter").style.display="none";BX("bx_sl_filter_hidden").style.display="block"}}if(!window.XMLHttpRequest){var XMLHttpRequest=function(){try{return new ActiveXObject("MSXML3.XMLHTTP")}catch(e){}try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}var sonetLXmlHttpGet=new XMLHttpRequest;var sonetLXmlHttpSet=new XMLHttpRequest;var LBlock=new BX.CLBlock;function __logOnAjaxInsertToNode(e){var t=false;if(BX("sonet_log_more_container")){nodeTmp1=BX.findChild(BX("sonet_log_more_container"),{tag:"span",className:"feed-new-message-inf-text"},false);nodeTmp2=BX.findChild(BX("sonet_log_more_container"),{tag:"span",className:"feed-new-message-inf-text-waiting"},false);if(nodeTmp1&&nodeTmp2){nodeTmp1.style.display="none";nodeTmp2.style.display="inline"}t=BX.pos(BX("sonet_log_more_container"));nodeTmp1Cap=document.body.appendChild(BX.create("div",{style:{position:"absolute",width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:1e3}}))}if(BX("sonet_log_counter_2_container")){nodeTmp1=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text"},false);nodeTmp2=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text-waiting"},false);if(nodeTmp1&&nodeTmp2){nodeTmp1.style.display="none";nodeTmp2.style.display="inline"}t=BX.pos(BX("sonet_log_more_container"));nodeTmp2Cap=document.body.appendChild(BX.create("div",{style:{position:"absolute",width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:1e3}}))}BX.unbind(BX("sonet_log_counter_2_container"),"click",__logOnAjaxInsertToNode)}function sonetLClearContainerExternalNew(){logAjaxMode="new"}function sonetLClearContainerExternalMore(){logAjaxMode="more"}function _sonetLClearContainerExternal(e){if(BX("sonet_log_more_container")){nodeTmp1=BX.findChild(BX("sonet_log_more_container"),{tag:"span",className:"feed-new-message-inf-text"},false);nodeTmp2=BX.findChild(BX("sonet_log_more_container"),{tag:"span",className:"feed-new-message-inf-text-waiting"},false);if(nodeTmp1&&nodeTmp2){nodeTmp1.style.display="inline";nodeTmp2.style.display="none"}}if(BX("sonet_log_counter_2_wrap")){BX.removeClass(BX("sonet_log_counter_2_wrap"),"feed-new-message-informer-anim");BX("sonet_log_counter_2_wrap").style.visibility="hidden"}if(BX("sonet_log_counter_2_container")){nodeTmp1=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text"},false);nodeTmp2=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text-waiting"},false);nodeTmp3=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text-reload"},false);if(nodeTmp1&&nodeTmp2&&nodeTmp3){nodeTmp1.style.display="inline";nodeTmp2.style.display="none";nodeTmp3.style.display="none"}}if(nodeTmp1Cap&&nodeTmp1Cap.parentNode){nodeTmp1Cap.parentNode.removeChild(nodeTmp1Cap)}if(nodeTmp2Cap&&nodeTmp2Cap.parentNode){nodeTmp2Cap.parentNode.removeChild(nodeTmp2Cap)}if(BX("sonet_log_counter_preset")&&logAjaxMode=="new"){BX("sonet_log_counter_preset").style.display="none"}}function __logChangeCounter(e){var t=parseInt(e)<=0;oCounter={iCommentsRead:0};BX.onCustomEvent(window,"onSonetLogChangeCounter",[oCounter]);e-=oCounter.iCommentsRead;__logChangeCounterAnimate(parseInt(e)>0,e,t)}function __logDecrementCounter(e){if(BX("sonet_log_counter_2")){e=parseInt(e);var t=parseInt(BX("sonet_log_counter_2").innerHTML);var n=t-e;if(n>0)BX("sonet_log_counter_2").innerHTML=n;else __logChangeCounterAnimate(false,0)}}function __logChangeCounterAnimate(e,t,n){n=!!n;if(!!window.bLockCounterAnimate){setTimeout(function(){__logChangeCounterAnimate(e,t)},200);return false}e=!!e;if(e){if(BX("sonet_log_counter_2"))BX("sonet_log_counter_2").innerHTML=t;if(BX("sonet_log_counter_2_wrap")){BX("sonet_log_counter_2_wrap").style.visibility="visible";BX.addClass(BX("sonet_log_counter_2_wrap"),"feed-new-message-informer-anim")}}else if(BX("sonet_log_counter_2_wrap")){if(n&&BX.hasClass(BX("sonet_log_counter_2_wrap"),"feed-new-message-informer-anim")){if(BX("sonet_log_counter_2_container")){nodeTmp1=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text"},false);nodeTmp2=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text-waiting"},false);nodeTmp3=BX.findChild(BX("sonet_log_counter_2_container"),{tag:"span",className:"feed-new-message-inf-text-reload"},false);if(nodeTmp1&&nodeTmp2&&nodeTmp3){nodeTmp1.style.display="none";nodeTmp2.style.display="none";nodeTmp3.style.display="inline"}}}else setTimeout(function(){BX.removeClass(BX("sonet_log_counter_2_wrap"),"feed-new-message-informer-anim");BX("sonet_log_counter_2_wrap").style.visibility="hidden"},400)}}function __logChangeCounterArray(e){if(typeof e[BX.message("sonetLCounterType")]!="undefined")__logChangeCounter(e[BX.message("sonetLCounterType")])}function __logShowPostMenu(e,t,n,o,s,i,a,r,l,d){BX.PopupMenu.destroy("post-menu-"+t);var f=null;if(BX.message("sonetLbUseFavorites")!="N"){f={text:l?BX.message("sonetLMenuFavoritesTitleY"):BX.message("sonetLMenuFavoritesTitleN"),className:"menu-popup-no-icon",onclick:function(e){__logChangeFavorites(r,"log_entry_favorites_"+r,l?"N":"Y",true);return BX.PreventDefault(e)}}}var m=[e.getAttribute("data-log-entry-url").length>0?{text:'<span id="post-menu-'+t+'-href-text">'+BX.message("sonetLMenuHref")+"</span>",className:"menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-href",href:e.getAttribute("data-log-entry-url")}:null,e.getAttribute("data-log-entry-url").length>0?{text:'<span id="post-menu-'+t+'-link-text">'+BX.message("sonetLMenuLink")+"</span>",className:"menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-link",onclick:function(){id="post-menu-"+t+"-link",it=BX.proxy_context,height=parseInt(!!it.getAttribute("bx-height")?it.getAttribute("bx-height"):it.offsetHeight);if(it.getAttribute("bx-status")!="shown"){it.setAttribute("bx-status","shown");if(!BX(id)&&!!BX(id+"-text")){var n=BX(id+"-text"),o=BX.pos(n),s=BX.pos(n.parentNode);pos3=BX.pos(BX.findParent(n,{className:"menu-popup-item"},true));o["height"]=s["height"]-1;BX.adjust(it,{attrs:{"bx-height":it.offsetHeight},style:{overflow:"hidden",display:"block"},children:[BX.create("BR"),BX.create("DIV",{attrs:{id:id},children:[BX.create("SPAN",{attrs:{className:"menu-popup-item-left"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-icon"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-text"},children:[BX.create("INPUT",{attrs:{id:id+"-input",type:"text",value:e.getAttribute("data-log-entry-url")},style:{height:o["height"]+"px",width:pos3["width"]-21+"px"},events:{click:function(e){this.select();BX.PreventDefault(e)}}})]})]}),BX.create("SPAN",{className:"menu-popup-item-right"})]})}new BX.fx({time:.2,step:.05,type:"linear",start:height,finish:height*2,callback:BX.delegate(function(e){this.style.height=e+"px"},it)}).start();BX.fx.show(BX(id),.2);BX(id+"-input").select()}else{it.setAttribute("bx-status","hidden");new BX.fx({time:.2,step:.05,type:"linear",start:it.offsetHeight,finish:height,callback:BX.delegate(function(e){this.style.height=e+"px"},it)}).start();BX.fx.hide(BX(id),.2)}}}:null,f,BX.message("sonetLCanDelete")=="Y"?{text:BX.message("sonetLMenuDelete"),className:"menu-popup-no-icon",onclick:function(e){if(confirm(BX.message("sonetLMenuDeleteConfirm"))){__logDelete(r,"log-entry-"+r,t)}return BX.PreventDefault(e)}}:null];if(!!d&&BX.type.isArray(d)){for(var p=0;p<d.length;p++)if(typeof d[p].className=="undefined")d[p].className="menu-popup-no-icon";m=BX.util.array_merge(m,d)}var c={offsetLeft:-14,offsetTop:4,lightShadow:false,angle:{position:"top",offset:50},events:{onPopupShow:function(e){if(BX("log_entry_favorites_"+r)){var n=BX.findChildren(e.contentContainer,{className:"menu-popup-item-text"},true);if(n!=null){for(var o=0;o<n.length;o++){if(n[o].innerHTML==BX.message("sonetLMenuFavoritesTitleY")||n[o].innerHTML==BX.message("sonetLMenuFavoritesTitleN")){var s=n[o];break}}}if(s!=undefined){if(BX.hasClass(BX("log_entry_favorites_"+r),"feed-post-important-switch-active"))BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleY");else BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleN")}}if(BX("post-menu-"+t+"-link")){var i=BX.findChild(e.popupContainer,{className:"feed-entry-popup-menu-link"},true,false);if(i){var a=parseInt(!!i.getAttribute("bx-height")?i.getAttribute("bx-height"):0);if(a>0){BX("post-menu-"+t+"-link").style.display="none";i.setAttribute("bx-status","hidden");i.style.height=a+"px"}}}}}};BX.PopupMenu.show("post-menu-"+t,e,m,c)}function __logCommentFormAutogrow(e){var t=0;if(e&&BX.type.isDomNode(e))var n=e;else{var n=BX.proxy_context;var o=e||window.event;if((o.keyCode==13||o.keyCode==10)&&o.ctrlKey)__logCommentAdd()}var s=BX.findParent(n,{className:"sonet-log-comment-form-place"});if(BX(s))t=BX(s).offsetHeight;var i=0;var a=n.value.split("\n");for(var r=a.length-1;r>=0;--r)i+=Math.floor(a[r].length/CommentFormColsDefault+1);if(i>=CommentFormRowsDefault)n.rows=i+1;else n.rows=CommentFormRowsDefault}function __logGetNextPage(e,t,n){if(oLF.bLoadStarted){return false}oLF.bLoadStarted=true;window.bLockCounterAnimate=true;t=!!t;if(!t&&BX("feed-new-message-inf-wrap")){BX("feed-new-message-inf-wrap").classList.toggle("feed-new-message-anim")}var o={method:"GET",url:e};BX.onCustomEvent("SonetLogBeforeGetNextPage",[o]);if(BX.type.isNotEmptyString(o.url)){e=o.url}BX.ajax({url:e,method:"GET",dataType:"html",data:{},onsuccess:function(e){oLF.bLoadStarted=false;if(!t&&typeof n!="undefined"&&n&&n.parentNode){BX.cleanNode(n.parentNode,true)}window.bLockCounterAnimate=false;if(e.length>0){var o="content_block_"+Math.floor(Math.random()*1e3);BX("log_internal_container").appendChild(BX.create("DIV",{props:{id:o,className:"feed-wrap"},style:{display:t?"none":"block"},html:e}));_sonetLClearContainerExternal(false);if(t){BX("feed-new-message-inf-wrap-first").style.display="block";var s=function(){if(BX(o)){BX(o).style.display="block"}BX.unbind(BX("sonet_log_more_container_first"),"click",s);BX("feed-new-message-inf-wrap-first").style.display="none";__logRecalcMoreButton()};BX.bind(BX("sonet_log_more_container_first"),"click",s)}else{setTimeout(function(){__logRecalcMoreButton()},1e3)}}},onfailure:function(e){oLF.bLoadStarted=false;if(!t&&BX("feed-new-message-inf-wrap")){BX("feed-new-message-inf-wrap").classList.toggle("feed-new-message-anim")}window.bLockCounterAnimate=false;_sonetLClearContainerExternal(false)}});return false}function __logGetNextPageLinkEntities(e,t){if(!!window.__logGetNextPageFormName&&!!e&&!!t&&!!window["UC"]&&!!window["UC"][window.__logGetNextPageFormName]&&!!window["UC"][window.__logGetNextPageFormName].linkEntity){window["UC"][window.__logGetNextPageFormName].linkEntity(e);for(var n in t){if(!!n&&!!t[n])window["UC"][window.__logGetNextPageFormName]["entitiesCorrespondence"][n]=t[n]}}}function __logRefresh(e){if(oLF.bLoadStarted){return}var t=BX("sonet_log_counter_2_wrap",true);oLF.bLoadStarted=true;if(t){var n=BX.findChild(t,{tag:"span",className:"feed-new-message-inf-text-reload"},true);if(n){n.style.display="none"}}window.bLockCounterAnimate=true;BX.ajax({url:e,method:"GET",dataType:"json",data:{},onsuccess:function(e){oLF.bLoadStarted=false;if(typeof e!="undefined"&&typeof e.TEXT!="undefined"&&e.TEXT.length>0){window.bLockCounterAnimate=false;BX.cleanNode("log_internal_container",false);BX("log_internal_container").appendChild(BX.create("DIV",{props:{className:"feed-wrap"},html:e.TEXT}));var n=BX.processHTML(e.TEXT,true);var o=n.SCRIPT;setTimeout(function(){BX.ajax.processScripts(o,true)},500);_sonetLClearContainerExternal(false);window.bStopTrackNextPage=false;if(BX("feed-new-message-inf-wrap-first")){BX("feed-new-message-inf-wrap-first").style.display="none"}if(typeof arCommentsMoreButtonID!="undefined"){arCommentsMoreButtonID=[]}if(t&&BX.hasClass(t,"feed-new-message-informer-fixed")){var s=BX("feed-up-btn-wrap",true);if(s){s.style.display="none";BX.removeClass(s,"feed-up-btn-wrap-anim")}var i=BX.GetWindowScrollPos();new BX.easing({duration:500,start:{scroll:i.scrollTop},finish:{scroll:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(e){window.scrollTo(0,e.scroll)},complete:function(){if(s)s.style.display="block";BX.onCustomEvent(window,"onGoUp")}}).animate()}}else{oLF.showRefreshError()}},onfailure:function(e){oLF.bLoadStarted=false;oLF.showRefreshError()}});return false}function __logChangeFavorites(e,t,n,o){if(!e||!BX(t)){return}if(!!o){var s=BX.proxy_context;if(!BX.hasClass(BX(s),"menu-popup-item-text")){s=BX.findChild(BX(s),{className:"menu-popup-item-text"},true)}}var i=BX.hasClass(BX(t),"feed-post-important-switch")?BX(t):BX.findChild(BX(t),{className:"feed-post-important-switch"});if(n!=undefined){if(n=="Y"){BX.addClass(BX(i),"feed-post-important-switch-active");BX(i).title=BX.message("sonetLMenuFavoritesTitleY");if(typeof s!="undefined"){BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleY")}}else{BX.removeClass(BX(i),"feed-post-important-switch-active");BX(i).title=BX.message("sonetLMenuFavoritesTitleN");if(typeof s!="undefined"){BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleN")}}}var a=new XMLHttpRequest;a.open("POST",BX.message("sonetLESetPath"),true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){var e=LBlock.DataParser(a.responseText);if(typeof e=="object"){if(e[0]=="*"){if(sonetLErrorDiv!=null){sonetLErrorDiv.style.display="block";sonetLErrorDiv.innerHTML=a.responseText}return}a.abort();var t="";if(e["bResult"]!=undefined&&(e["bResult"]=="Y"||e["bResult"]=="N")){if(e["bResult"]=="Y"){BX.addClass(BX(i),"feed-post-important-switch-active");BX(i).title=BX.message("sonetLMenuFavoritesTitleY");if(s!=undefined)BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleY")}else{BX.removeClass(BX(i),"feed-post-important-switch-active");BX(i).title=BX.message("sonetLMenuFavoritesTitleN");if(s!=undefined)BX(s).innerHTML=BX.message("sonetLMenuFavoritesTitleN")}}}}else{}}};a.send("r="+Math.floor(Math.random()*1e3)+"&"+BX.message("sonetLSessid")+"&site="+BX.util.urlencode(BX.message("sonetLSiteId"))+"&log_id="+encodeURIComponent(e)+"&action=change_favorites")}function __logDelete(e,t,n){if(!e){return}if(!BX(t)){return}BX.ajax({url:BX.message("sonetLESetPath"),method:"POST",dataType:"json",data:{sessid:BX.bitrix_sessid(),site:BX.message("sonetLSiteId"),log_id:e,action:"delete"},onsuccess:function(e){if(e.bResult!=undefined&&e.bResult=="Y"){if(typeof n!="undefined"){BX.PopupMenu.destroy("post-menu-"+n)}__logDeleteSuccess(BX(t))}else{__logDeleteFailure(BX(t))}},onfailure:function(e){__logDeleteFailure(BX(t))}})}function __logDeleteSuccess(e){if(typeof e=="undefined"||!e||!BX(e)){return}new BX.fx({time:.5,step:.05,type:"linear",start:BX(e).offsetHeight,finish:60,callback:BX.delegate(function(e){this.style.height=e+"px"},BX(e)),callback_start:BX.delegate(function(){this.style.overflow="hidden";this.style.minHeight=0},BX(e)),callback_complete:BX.delegate(function(){this.style.marginBottom=0;BX.cleanNode(this);this.appendChild(BX.create("DIV",{props:{className:"feed-add-successfully"},style:{marginLeft:"17px",marginRight:"17px",marginTop:"10px"},children:[BX.create("span",{props:{className:"feed-add-info-text"},children:[BX.create("span",{props:{className:"feed-add-info-icon"}}),BX.create("span",{html:BX.message("sonetLMenuDeleteSuccess")})]})]}))},BX(e))}).start()}function __logDeleteFailure(e){if(typeof e=="undefined"||!e||!BX(e)){return}e.insertBefore(BX.create("DIV",{props:{className:"feed-add-error"},style:{marginLeft:"84px",marginRight:"37px",marginTop:"18px",marginBottom:"4px"},children:[BX.create("span",{props:{className:"feed-add-info-text"},children:[BX.create("span",{props:{className:"feed-add-info-icon"}}),BX.create("span",{html:BX.message("sonetLMenuDeleteFailure")})]})]}),e.firstChild)}function __logOnFeedScroll(){if(window.feedScrollLock==undefined||window.feedScrollLock===false){window.feedScrollLock=true;setTimeout(function(){window.feedScrollLock=false},100);var e=BX.GetWindowSize();if(window.bStopTrackNextPage===undefined||window.bStopTrackNextPage==false){var t=parseInt(e.scrollHeight/2);if(e.scrollHeight-e.innerHeight<t){t=1}if(e.scrollTop>=t&&next_url){window.bStopTrackNextPage=true;__logGetNextPage(next_url,true)}}}var n=BX("sonet_log_counter_2_wrap",true);if(n){var o=n.parentNode.getBoundingClientRect().top;if(o<=0){BX.addClass(n,"feed-new-message-informer-fixed");setTimeout(function(){if(BX.hasClass(n,"feed-new-message-informer-fixed")){BX.addClass(n,"feed-new-message-informer-fix-anim")}},100)}else{BX.removeClass(n,"feed-new-message-informer-fixed feed-new-message-informer-fix-anim")}}}function __logScrollInit(e){if(!!e){BX.unbind(window,"scroll",__logOnFeedScroll);BX.bind(window,"scroll",__logOnFeedScroll)}else{BX.unbind(window,"scroll",__logOnFeedScroll)}}function __logRecalcMoreButton(){if(typeof arMoreButtonID!="undefined"){var e=false;var t=false;var n=false;var o=false;for(var s=0;s<arMoreButtonID.length;s++){e=BX.pos(BX(arMoreButtonID[s].bodyBlockID));if(e.height<280){BX(arMoreButtonID[s].moreButtonBlockID).style.display="none"}if(typeof arMoreButtonID[s].outerBlockID!="undefined"){n=BX(arMoreButtonID[s].outerBlockID);if(n){t=BX.pos(n);if(t.width<e.width){o=BX.findChild(n,{tag:"div",className:"feed-post-text-block-inner"},false);o.style.overflowX="scroll"}}}}}if(typeof arCommentsMoreButtonID!="undefined"){var e=false;for(var s=0;s<arCommentsMoreButtonID.length;s++){e=BX.pos(BX(arCommentsMoreButtonID[s].bodyBlockID));if(e.height<202){BX(arCommentsMoreButtonID[s].moreButtonBlockID).style.display="none"}}}}window.__socOnUCFormClear=function(e){LHEPostForm.reinitDataBefore(e.editorId)};window.__socOnUCFormAfterShow=function(e,t,n){n=!!n?n:{};var o=e.entitiesCorrespondence[e.id.join("-")][0],s=e.entitiesCorrespondence[e.id.join("-")][1];BX.show(BX("feed_comments_block_"+o));BX.onCustomEvent(window,"OnBeforeSocialnetworkCommentShowedUp",["socialnetwork"]);e.form.action=e.url.replace(/\#eId\#/,o).replace(/\#id\#/,s);var i={ENTITY_XML_ID:e.id[0],ENTITY_TYPE:e.entitiesId[e.id[0]][0],ENTITY_ID:e.entitiesId[e.id[0]][1],parentId:e.id[1],comment_post_id:e.entitiesId[e.id[0]][1],edit_id:e.id[1],act:e.id[1]>0?"edit":"add",logId:e.entitiesId[e.id[0]][2]};for(var a in i){if(!e.form[a]){e.form.appendChild(BX.create("INPUT",{attrs:{name:a,type:"hidden"}}))}e.form[a].value=i[a]}__socOnLightEditorShow(t,n)};window.__socOnUCFormSubmit=function(e,t){t["r"]=Math.floor(Math.random()*1e3);t["sessid"]=BX.bitrix_sessid();t["log_id"]=e.entitiesCorrespondence[e.id.join("-")][0];t["p_smile"]=BX.message("sonetLPathToSmile");t["p_ubp"]=BX.message("sonetLPathToUserBlogPost");t["p_gbp"]=BX.message("sonetLPathToGroupBlogPost");t["p_umbp"]=BX.message("sonetLPathToUserMicroblogPost");t["p_gmbp"]=BX.message("sonetLPathToGroupMicroblogPost");t["p_user"]=BX.message("sonetLPathToUser");t["f_id"]=BX.message("sonetLForumID");t["bapc"]=BX.message("sonetLBlogAllowPostCode");t["site"]=BX.message("sonetLSiteId");t["lang"]=BX.message("sonetLLangId");t["nt"]=BX.message("sonetLNameTemplate");t["sl"]=BX.message("sonetLShowLogin");t["as"]=BX.message("sonetLAvatarSizeComment");t["dtf"]=BX.message("sonetLDateTimeFormat");t["message"]=t["REVIEW_TEXT"];t["action"]="add_comment";t["RATING_TYPE"]=BX.message("sonetRatingType");t["pull"]="Y";t["crm"]=BX.message("sonetLIsCRM");e.form["bx-action"]=e.form.action;e.form.action=BX.message("sonetLESetPath")};window.__socOnUCFormResponse=function(e,t){e.form.action=e.form["bx-action"];var n={errorMessage:t},o=e.entitiesCorrespondence[e.id.join("-")][0],s={};if(!(!!t&&typeof t=="object")){}else if(t[0]=="*"){n={errorMessage:BX.message("sonetLErrorSessid")}}else{if(!(t["commentID"]>0)||!!t["strMessage"]){n["errorMessage"]=t["strMessage"]}else{var i=t["arCommentFormatted"],a=t["arComment"],r=!!window["__logBuildRating"]?window["__logBuildRating"](t["arComment"],t["arCommentFormatted"]):null,l=!!a["SOURCE_ID"]?a["SOURCE_ID"]:a["ID"],s={ID:l,ENTITY_XML_ID:e.id[0],FULL_ID:[e.id[0],l],NEW:"N",APPROVED:"Y",POST_TIMESTAMP:t["timestamp"]-BX.message("USER_TZ_OFFSET"),POST_TIME:i["LOG_TIME_FORMAT"],POST_DATE:i["LOG_TIME_FORMAT"],"~POST_MESSAGE_TEXT":i["MESSAGE"],POST_MESSAGE_TEXT:i["MESSAGE_FORMAT"],PANELS:{MODERATE:false},URL:{LINK:a["URL"].length>0?a["URL"]:BX.message("sonetLEPath").replace("#log_id#",a["LOG_ID"])+"?commentId="+a["ID"]+"#com"+(parseInt(a["SOURCE_ID"])>0?a["SOURCE_ID"]:a["ID"])},AUTHOR:{ID:i["USER_ID"],NAME:i["CREATED_BY"]["FORMATTED"],URL:i["CREATED_BY"]["URL"],AVATAR:i["AVATAR_SRC"]},BEFORE_ACTIONS:!!r?r:"",AFTER:i["UF"]};if(typeof t["hasEditCallback"]!="undefined"&&t["hasEditCallback"]=="Y"){s["PANELS"]["EDIT"]="Y";s["URL"]["EDIT"]="__logEditComment('"+e.id[0]+"', '"+a["ID"]+"', '"+a["LOG_ID"]+"');"}if(typeof t["hasDeleteCallback"]!="undefined"&&t["hasDeleteCallback"]=="Y"){s["PANELS"]["DELETE"]="Y";s["URL"]["DELETE"]=BX.message("sonetLESetPath")+"?lang="+BX.message("sonetLLangId")+"&action=delete_comment&delete_comment_id="+a["ID"]+"&post_id="+a["LOG_ID"]+"&site="+BX.message("sonetLSiteId")}n={errorMessage:"",okMessage:"",status:true,message:"",messageCode:i["MESSAGE"],messageId:[e.id[0],l],"~message":"",messageFields:s}}var d=BX("log_entry_follow_"+o,true),f=!!d?d.getAttribute("data-follow")=="Y"?"Y":"N":false;if(f=="N"){BX.findChild(d,{tagName:"a"}).innerHTML=BX.message("sonetLFollowY");d.setAttribute("data-follow","Y")}var d=BX("feed-comments-all-cnt-"+o,true),m=!!d?d.innerHTML.length>0?parseInt(d.innerHTML):0:false;if(m!==false)d.innerHTML=m+1}e.OnUCFormResponseData=n};window.__socOnLightEditorShow=function(e,t){var n={};if(t["arFiles"]){var o={},s,i;for(var a=0;a<t["arFiles"].length;a++){s=BX.findChild(BX("wdif-doc-"+t["arFiles"][a]),{className:"feed-com-file-name"},true);i=BX.findChild(BX("wdif-doc-"+t["arFiles"][a]),{className:"feed-con-file-size"},true);o["F"+a]={FILE_ID:t["arFiles"][a],FILE_NAME:s?s.innerHTML:"noname",FILE_SIZE:i?i.innerHTML:"unknown",CONTENT_TYPE:"notimage/xyz"}}n["UF_SONET_COM_DOC"]={USER_TYPE_ID:"file",FIELD_NAME:"UF_SONET_COM_FILE[]",VALUE:o}}if(t["arDocs"])n["UF_SONET_COM_FILE"]={USER_TYPE_ID:"webdav_element",FIELD_NAME:"UF_SONET_COM_DOC[]",VALUE:BX.clone(t["arDocs"])};if(t["arDFiles"])n["UF_SONET_COM_FILE"]={USER_TYPE_ID:"disk_file",FIELD_NAME:"UF_SONET_COM_DOC[]",VALUE:BX.clone(t["arDFiles"])};LHEPostForm.reinitData(SLEC.editorId,e,n)};BitrixLF=function(){this.bLoadStarted=false};BitrixLF.prototype.showRefreshError=function(){window.bLockCounterAnimate=false;_sonetLClearContainerExternal(false)};BitrixLF.prototype.LazyLoadCheckVisibility=function(e){var t=e.node;var n="comment";var o=BX.findParent(t,{className:"feed-com-text"});if(!o){n="post";o=BX.findParent(t,{className:"feed-post-text-block"})}if(o){var s=BX.findChild(o,{tag:"div",className:"feed-post-text-more"},false);if(s&&s.style.display!="none"){return t.parentNode.parentNode.offsetTop<(n=="comment"?220:270)}}return true};oLF=new BitrixLF;window.oLF=oLF;
//# sourceMappingURL=script.map.js