BX.LiveFeedShowClass=function(){var s=function(s){this.ajaxUrl="/bitrix/components/bitrix/lists.lists/ajax.php";this.randomString=s.randomString};s.prototype.showLiveFeed=function(s){BX.ajax({method:"POST",dataType:"json",url:this.addToLinkParam(this.ajaxUrl,"action","setLiveFeed"),data:{iblockId:s,checked:BX("bx-lists-show-live-feed-"+s).checked,sessid:BX.bitrix_sessid()},onsuccess:BX.delegate(function(s){if(s.status=="error"){s.errors=s.errors||[{}];this.showModalWithStatusAction({status:"error",message:s.errors.pop().message})}},this)})};s.prototype.createDefaultProcesses=function(){BX.addClass(BX("bx-lists-default-processes"),"webform-small-button-wait");BX("bx-lists-default-processes").setAttribute("onclick","");BX.ajax({method:"POST",dataType:"json",url:this.addToLinkParam(this.ajaxUrl,"action","createDefaultProcesses"),data:{siteId:BX("bx-lists-select-site").value,sessid:BX.bitrix_sessid()},onsuccess:BX.delegate(function(s){if(s.status=="success"){location.reload()}else{BX("bx-lists-default-processes").setAttribute("onclick",'BX["LiveFeedShowClass_'+this.randomString+'"].createDefaultProcesses();');s.errors=s.errors||[{}];this.showModalWithStatusAction({status:"error",message:s.errors.pop().message});BX.removeClass(BX("bx-lists-default-processes"),"webform-small-button-wait")}},this)})};s.prototype.addToLinkParam=function(s,e,t){if(!s.length){return"?"+e+"="+t}s=BX.util.remove_url_param(s,e);if(s.indexOf("?")!=-1){return s+"&"+e+"="+t}return s+"?"+e+"="+t};s.prototype.showModalWithStatusAction=function(s,e){s=s||{};if(!s.message){if(s.status=="success"){s.message=BX.message("LISTS_JS_STATUS_ACTION_SUCCESS")}else{s.message=BX.message("LISTS_JS_STATUS_ACTION_ERROR")+". "+this.getFirstErrorFromResponse(s)}}var t=BX.create("div",{props:{className:"bx-lists-alert"},children:[BX.create("span",{props:{className:"bx-lists-aligner"}}),BX.create("span",{props:{className:"bx-lists-alert-text"},text:s.message}),BX.create("div",{props:{className:"bx-lists-alert-footer"}})]});var a=BX.PopupWindowManager.getCurrentPopup();if(a){a.destroy()}var o=setTimeout(function(){var s=BX.PopupWindowManager.getCurrentPopup();if(!s||s.uniquePopupId!="bx-lists-status-action"){return}s.close();s.destroy()},3e3);var r=BX.PopupWindowManager.create("bx-lists-status-action",null,{content:t,onPopupClose:function(){this.destroy();clearTimeout(o)},autoHide:true,zIndex:2e3,className:"bx-lists-alert-popup"});r.show();BX("bx-lists-status-action").onmouseover=function(s){clearTimeout(o)};BX("bx-lists-status-action").onmouseout=function(s){o=setTimeout(function(){var s=BX.PopupWindowManager.getCurrentPopup();if(!s||s.uniquePopupId!="bx-lists-status-action"){return}s.close();s.destroy()},3e3)}};return s}();
//# sourceMappingURL=script.map.js